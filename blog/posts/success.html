<!DOCTYPE html><html><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width, initial-scale=1" data-next-head=""/><link rel="icon" href="/favicon.ico?v=20250815" data-next-head=""/><meta name="description" content="My personal blog website using Next.js" data-next-head=""/><meta property="og:image" content="https://og-image.vercel.app/Praneel&#x27;s.png?theme=light&amp;md=0&amp;fontSize=75px&amp;images=https%3A%2F%2Fassets.zeit.co%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg" data-next-head=""/><meta name="og:title" content="Praneel&#x27;s" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><link rel="preload" href="/images/profile.jpg" as="image" data-next-head=""/><title data-next-head="">Success</title><link rel="preload" href="/_next/static/css/028bc270bf4a6223.css" as="style"/><link rel="preload" href="/_next/static/css/2a78c0822e09b55b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/028bc270bf4a6223.css" data-n-g=""/><link rel="stylesheet" href="/_next/static/css/2a78c0822e09b55b.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-b9bae0de6673f52f.js" defer=""></script><script src="/_next/static/chunks/framework-5757b756ea7e1d52.js" defer=""></script><script src="/_next/static/chunks/main-ef7d23a664038fd9.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ffccb56e44abc4d6.js" defer=""></script><script src="/_next/static/chunks/388-30f901fc1c5490c7.js" defer=""></script><script src="/_next/static/chunks/52-83056434d003f40f.js" defer=""></script><script src="/_next/static/chunks/pages/blog/posts/%5Bid%5D-965f4937a890e951.js" defer=""></script><script src="/_next/static/-PcuL9eVPypQ9jy2E-T2Y/_buildManifest.js" defer=""></script><script src="/_next/static/-PcuL9eVPypQ9jy2E-T2Y/_ssgManifest.js" defer=""></script></head><body><script>
(function() {
  try {
    var stored = localStorage.getItem('theme');
    var theme = stored === 'dark' ? 'dark' : 'light';
    document.documentElement.setAttribute('data-theme', theme);
  } catch (e) {
    document.documentElement.setAttribute('data-theme', 'light');
  }
})();</script><link rel="preload" as="image" href="/images/profile.jpg"/><div id="__next"><div class="layout_container__FUycR"><header class="layout_header__SFlEE"><div style="align-self:flex-end"><button aria-label="Toggle theme" style="background:transparent;border:1px solid var(--border);color:var(--text);padding:6px 10px;border-radius:8px;cursor:pointer;font-weight:600">Dark mode</button></div><a href="/"><img alt="Praneel" width="108" height="108" decoding="async" data-nimg="1" class="utils_borderCircle__zmKqF" style="color:transparent" src="/images/profile.jpg"/></a><h2 class="utils_headingLg__RYtYb"><a class="utils_colorInherit__Jz9NS" href="/">Praneel</a></h2></header><main><div style="margin-top:0.5rem;margin-bottom:0.75rem"><a style="border:1px solid var(--border);border-radius:10px;padding:8px 12px;text-decoration:none;color:var(--text)" href="/blog">← Back to blog</a></div><article><h1 class="utils_headingXl__zlq1q">Success</h1><div class="utils_lightText__B_gv3"><time dateTime="2025-08-20">August 20, 2025</time></div><div class="markdown"><p>If you are reading this, I have successfully manage to deploy my website on <strong>Amazon S3 + CloudFront</strong>.</p>
<p><img src="/images/breaking-free.png" alt="free"></p>
<p>The shift to <strong>Amazon Web Services</strong> was a great decision. I’m now able to host my static websites for free and also get full CDN support.</p>
<p>It was a bit challenging to switch from <strong>Next.js</strong> to a static S3 setup, but I’m sure this will be worth it in the long run. Learning that Next.js has a built-in static export feature was really awesome, and the process of generating the files turned out to be pretty straightforward.</p>
<p>I first modified the <code>next.config.js</code> file as follows:</p>
<pre><code class="language-js">/** @type {import('next').NextConfig} */
const nextConfig = {
  output: "export",
  images: {
    unoptimized: true,
  },
};
module.exports = nextConfig;
</code></pre>
<p>Then, I ran the following command:</p>
<p><code>pnpm build</code></p>
<p>This generated all the static files inside the /out folder. From there, I just uploaded them to my S3 bucket and connected everything through a CloudFront distribution.</p>
<h1><strong>Some Issues I Faced :</strong></h1>
<h2>Invalidate the CloudFront Cache</h2>
<p>to clear any cached errors,</p>
<ol>
<li>In your CloudFront distribution, click the Invalidations tab.</li>
<li>Click Create invalidation.</li>
<li>In the object paths field, enter /* to clear the cache for all files.</li>
<li>Click Create invalidation.</li>
</ol>
<h2>Fix url mismatch</h2>
<p>A mismatch between the "clean" URL your browser requests (/countdown) and the actual filename stored in your S3 bucket (countdown.html). When CloudFront receives the request for /countdown, it passes it directly to S3, which then correctly reports that it can't find an object with that exact name, resulting in the "Access Denied" error (because the object doesn't exist to be accessed).</p>
<p>To fix this, Make a CloudFront Function Code</p>
<ol>
<li>In the AWS Console, navigate to CloudFront, then select Functions from the left-hand menu.</li>
<li>Click on the name of the function you created (e.g., <code>url-rewrite-function</code>)</li>
<li>Make sure the code in the editor is exactly this:</li>
</ol>
<pre><code>function handler(event) {
  var request = event.request;
  var uri = request.uri;

  // Check whether the URI is missing a file name.
  if (uri.endsWith('/')) {
      request.uri += 'index.html';
  }
  // Check whether the URI is missing a file extension.
  else if (!uri.includes('.')) {
      request.uri += '.html';
  }

  return request;
}
</code></pre>
<ol start="4">
<li>
<p>Navigate back to your CloudFront distribution.</p>
</li>
<li>
<p>Click on the Behaviors tab.</p>
</li>
<li>
<p>Select the checkbox next to the behavior with the path pattern Default (*) and click Edit.</p>
</li>
<li>
<p>Scroll down to the bottom to the Function associations section.</p>
</li>
<li>
<p>Under Viewer request - Function type, ensure CloudFront Function is selected.</p>
</li>
<li>
<p>Under Function ARN/Name, make sure the function you created (e.g., url-rewrite-function) is selected from the dropdown menu. It should look like this:</p>
</li>
<li>
<p>Click Save changes.</p>
</li>
</ol>
<p>The site should work flawlessly now!</p>
<p>It was hard to update it since i have to keep doing the same steps everytime i make changes, But thats a problem for future me to fix :P</p>
<p>Im sure ill learn about something until then, Ill leave here some links to help anyone who wants to do the same thing.</p>
<p><a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/static-website-hosting.html">https://docs.aws.amazon.com/AmazonS3/latest/userguide/static-website-hosting.html</a></p>
<p><a href="https://nextjs.org/docs/pages/guides/static-exports">How to create a static export of your Next.js application</a></p>
<p>Thanks for reading the update!</p>
</div></article><div style="margin-top:1rem;margin-bottom:0.5rem"><a style="border:1px solid var(--border);border-radius:10px;padding:8px 12px;text-decoration:none;color:var(--text)" href="/blog">← Back to blog</a></div></main><div style="margin-top:2rem;display:flex;justify-content:center"><span aria-label="/countdown" style="color:var(--text);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace;font-weight:700;font-size:1.25rem">365<!-- -->:<!-- -->08<!-- -->:<!-- -->34<!-- -->:<!-- -->27</span></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"success","contentHtml":"\u003cp\u003eIf you are reading this, I have successfully manage to deploy my website on \u003cstrong\u003eAmazon S3 + CloudFront\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/breaking-free.png\" alt=\"free\"\u003e\u003c/p\u003e\n\u003cp\u003eThe shift to \u003cstrong\u003eAmazon Web Services\u003c/strong\u003e was a great decision. I’m now able to host my static websites for free and also get full CDN support.\u003c/p\u003e\n\u003cp\u003eIt was a bit challenging to switch from \u003cstrong\u003eNext.js\u003c/strong\u003e to a static S3 setup, but I’m sure this will be worth it in the long run. Learning that Next.js has a built-in static export feature was really awesome, and the process of generating the files turned out to be pretty straightforward.\u003c/p\u003e\n\u003cp\u003eI first modified the \u003ccode\u003enext.config.js\u003c/code\u003e file as follows:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-js\"\u003e/** @type {import('next').NextConfig} */\r\nconst nextConfig = {\r\n  output: \"export\",\r\n  images: {\r\n    unoptimized: true,\r\n  },\r\n};\r\nmodule.exports = nextConfig;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThen, I ran the following command:\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epnpm build\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eThis generated all the static files inside the /out folder. From there, I just uploaded them to my S3 bucket and connected everything through a CloudFront distribution.\u003c/p\u003e\n\u003ch1\u003e\u003cstrong\u003eSome Issues I Faced :\u003c/strong\u003e\u003c/h1\u003e\n\u003ch2\u003eInvalidate the CloudFront Cache\u003c/h2\u003e\n\u003cp\u003eto clear any cached errors,\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eIn your CloudFront distribution, click the Invalidations tab.\u003c/li\u003e\n\u003cli\u003eClick Create invalidation.\u003c/li\u003e\n\u003cli\u003eIn the object paths field, enter /* to clear the cache for all files.\u003c/li\u003e\n\u003cli\u003eClick Create invalidation.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003eFix url mismatch\u003c/h2\u003e\n\u003cp\u003eA mismatch between the \"clean\" URL your browser requests (/countdown) and the actual filename stored in your S3 bucket (countdown.html). When CloudFront receives the request for /countdown, it passes it directly to S3, which then correctly reports that it can't find an object with that exact name, resulting in the \"Access Denied\" error (because the object doesn't exist to be accessed).\u003c/p\u003e\n\u003cp\u003eTo fix this, Make a CloudFront Function Code\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eIn the AWS Console, navigate to CloudFront, then select Functions from the left-hand menu.\u003c/li\u003e\n\u003cli\u003eClick on the name of the function you created (e.g., \u003ccode\u003eurl-rewrite-function\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eMake sure the code in the editor is exactly this:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode\u003efunction handler(event) {\r\n  var request = event.request;\r\n  var uri = request.uri;\r\n\r\n  // Check whether the URI is missing a file name.\r\n  if (uri.endsWith('/')) {\r\n      request.uri += 'index.html';\r\n  }\r\n  // Check whether the URI is missing a file extension.\r\n  else if (!uri.includes('.')) {\r\n      request.uri += '.html';\r\n  }\r\n\r\n  return request;\r\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003col start=\"4\"\u003e\n\u003cli\u003e\n\u003cp\u003eNavigate back to your CloudFront distribution.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eClick on the Behaviors tab.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSelect the checkbox next to the behavior with the path pattern Default (*) and click Edit.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eScroll down to the bottom to the Function associations section.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eUnder Viewer request - Function type, ensure CloudFront Function is selected.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eUnder Function ARN/Name, make sure the function you created (e.g., url-rewrite-function) is selected from the dropdown menu. It should look like this:\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eClick Save changes.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThe site should work flawlessly now!\u003c/p\u003e\n\u003cp\u003eIt was hard to update it since i have to keep doing the same steps everytime i make changes, But thats a problem for future me to fix :P\u003c/p\u003e\n\u003cp\u003eIm sure ill learn about something until then, Ill leave here some links to help anyone who wants to do the same thing.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/static-website-hosting.html\"\u003ehttps://docs.aws.amazon.com/AmazonS3/latest/userguide/static-website-hosting.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://nextjs.org/docs/pages/guides/static-exports\"\u003eHow to create a static export of your Next.js application\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eThanks for reading the update!\u003c/p\u003e\n","title":"Success","date":"2025-08-20"}},"__N_SSG":true},"page":"/blog/posts/[id]","query":{"id":"success"},"buildId":"-PcuL9eVPypQ9jy2E-T2Y","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>